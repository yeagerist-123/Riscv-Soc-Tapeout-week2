## 📝 Overview
The **VSDBabySoC** is a simple SoC (System-on-Chip) design, combining a RISC-V processor (`rvmyth`) 🖥️, a PLL (Phase-Locked Loop) module (`pll`) ⏰, and a DAC (Digital-to-Analog Converter) module (`dac`) 🎛️. This demo project showcases how to integrate these IP blocks and guides you through simulating and verifying the system with both pre-synthesis and post-synthesis flows! 🚦

## 🗂️ Project Structure
- `src/include/` 📁 – Header files (`*.vh`) with macros and parameters.
- `src/module/` 📁 – Verilog files for each module in the SoC.
- `output/` 📁 – All compiled outputs and simulation files.
- `compiled_tlv/` 📁 – Holds intermediate compiled files if needed.

## 🛠️ Requirements
Make sure you have **Icarus Verilog** 🧪 for compilation and **GTKWave** 🌊 for waveform viewing. This project is intended for Unix-like environments (macOS/Linux) 🐧🍎.

## 🚀 Step-by-Step Guide

### 1️⃣ Setup and Prepare Project Directory
Clone or organize your directory like this:
```txt
VSDBabySoC/
├── src/
│   ├── include/
│   │   ├── sandpiper.vh
│   │   └── other header files...
│   ├── module/
│   │   ├── vsdbabysoc.v      # Top-level module integrating all components
│   │   ├── rvmyth.v          # RISC-V core module
│   │   ├── avsdpll.v         # PLL module
│   │   ├── avsddac.v         # DAC module
│   │   └── testbench.v       # Testbench for simulation
└── output/
└── compiled_tlv/         # Holds compiled intermediate files if needed
```

### 🧩 Module Descriptions

#### 2.1 vsdbabysoc.v (Top-Level SoC Module) 🏆
This is the top-level module that integrates the rvmyth, pll, and dac modules.  


- **Inputs:**
  - reset 🔄: Resets the core processor.
  - VCO_IN, ENb_CP, ENb_VCO, REF: PLL control signals ⚡
  - VREFH: DAC reference voltage 🔋
- **Outputs:**
  - OUT: Analog output from DAC 📈
- **Connections:**
  - RV_TO_DAC: 10-bit bus that connects the RISC-V core output to the DAC input 🔗
  - CLK: Clock signal generated by PLL ⏰

#### 2.2 rvmyth.v (RISC-V Core) 🖥️
The rvmyth module is a simple RISC-V based processor. It outputs a 10-bit digital signal (OUT) to be converted by the DAC.  


- **Inputs:**
  - CLK: Clock signal generated by the PLL ⏰
  - reset: Initializes or resets the processor 🔄
- **Outputs:**
  - OUT: A 10-bit digital signal representing processed data to be sent to the DAC 🟦
 
  - ## Steps to follow

1. Install `iverilog` and `gtkwave`
2. Simulate rvmyth using the following steps:

     1. `git clone https://github.com/kunalg123/rvmyth/`
     2. `cd rvmyth`
     3. `iverilog mythcore_test.v tb_mythcore_test.v`
     4. `./a.out`
     5. `gtkwave tb_mythcore_test.vcd`
  
 
![image](https://user-images.githubusercontent.com/82170364/121876882-a6282700-cd27-11eb-9a3d-132172a2aac2.png)


 *10-bit digital codes observed at the output of rvmyth.*

#### 2.3 avsdpll.v (PLL Module) ⏰
The pll module is a phase-locked loop that generates a stable clock (CLK) for the RISC-V core.  


- **Inputs:**
  - VCO_IN, ENb_CP, ENb_VCO, REF: Control and reference signals for PLL operation ⚡
- **Output:**
  - CLK: A stable clock signal for synchronizing the core and other modules 🕒

#### 2.4 avsddac.v (DAC Module) 🎛️
The dac module converts the 10-bit digital signal from the rvmyth core to an analog output.  


- **Inputs:**
  - D: A 10-bit digital input from the processor 🔢
  - VREFH: Reference voltage for the DAC 🔋
- **Output:**
  - OUT: Analog output signal 📈

### 🧪 Testbench
The `testbench.v` file is a test module to verify the functionality of vsdbabysoc. It includes signal initialization, clock generation, and waveform dumping for both pre-synthesis and post-synthesis simulations.

**Waveform Output:**
- `pre_synth_sim.vcd` or `post_synth_sim.vcd` files generated based on simulation conditions.

---

## 🏃 Simulation Steps

### 🔬 Pre-Synthesis Simulation
Run:
```tcl
iverilog -o output/pre_synth_sim/pre_synth_sim.out -DPRE_SYNTH_SIM \
    -I src/include -I src/module \
    src/module/testbench.v src/module/vsdbabysoc.v
cd output/pre_synth_sim
./pre_synth_sim.out
```
![WhatsApp Image 2024-11-05 at 18 21 53](https://github.com/user-attachments/assets/71e2f05c-1688-4016-adf2-3ae8a874b18a)

**Explanation:**
- `-DPRE_SYNTH_SIM` 📢: Defines the PRE_SYNTH_SIM macro for conditional compilation in the testbench.
- The resulting `pre_synth_sim.vcd` file can be viewed in GTKWave 🌊.

### 👀 Viewing Waveform in GTKWave
After running the simulation, open the VCD file in GTKWave:
```
gtkwave output/pre_synth_sim/pre_synth_sim.vcd
```

### 🏗️ Post-Synthesis Simulation
To run a post-synthesis simulation, use:
```tcl
iverilog -o output/post_synth_sim/post_synth_sim.out -DPOST_SYNTH_SIM \
    -I src/include -I src/module \
    src/module/testbench.v output/synthesized/vsdbabysoc.synth.v
cd output/post_synth_sim
./post_synth_sim.out
```

---

## 🦺 Troubleshooting Tips

- **Module Redefinition ⚠️:** If you encounter redefinition errors, ensure modules are included only once, either in the testbench or in the command line.
- **Path Issues 🛤️:** Verify paths specified with `-I` are correct. Use full/absolute paths if relative paths cause errors.
- **Simulation Output 📄:** If output files aren’t generated, check your simulation and compilation logs for errors.
- **GTKWave Display 🖼️:** If signals aren’t visible, ensure the VCD dump is correctly configured in the testbench.

---

Enjoy building and simulating your BabySoC! 🎉🛠️
